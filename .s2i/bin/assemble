#!/bin/bash

# this assemble script will run "around" the standard python/django s2i assemble script to do a couple of things:
# - install some additional dependencies/plugins that we want for our deployment
# - "overlay" some  deployment-related files that will help us deploy the app in OpenShift/k8s

# additional dependencies
pip install -r requirements.txt

# overlay files
if [ -d "../overlay" ]; then
    echo "Copying overlay files into place..."
    cp -r ../overlay/* ../../
fi

echo "Running default assemble script..."

/usr/libexec/s2i/assemble
rc=$?

if [ $rc -eq 0 ]; then
    echo "Default assemble succeeded."
else
    echo "Default assemble  failed."
fi

echo "Assemble done."

exit $rc
